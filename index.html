<script src="https://apis.google.com/js/api.js"></script>
<script src="https://accounts.google.com/gsi/client" async defer></script>


<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="format-detection" content="telephone=no">
    <link href="https://fonts.googleapis.com/earlyaccess/nicomoji.css" rel="stylesheet">
    <title>イケルカネ</title>
    <link rel="stylesheet" href="css/style.css">
</head>

<body>
    <h1 class="main-title">イケルカネ</h1>
    <p class="catch">
        お金の抑止力で<br>
        遅刻をさせない
    </p>
    <img src="images/cloud1.png" class="cloud1">
    <img src="images/cloud2.png" class="cloud2">

    <a href="register.html" class="Touroku" id="registerLink">アカウント登録</a>
    
    <div style="text-align: center; margin-top: 20px;">
        <a href="admin.html" style="color: #666; text-decoration: none; font-size: 12px;">管理者ログイン</a>
    </div>
    
    <div id="map"></div>

    <script>
        // ページ読み込み時に登録済みかチェック
        document.addEventListener('DOMContentLoaded', function() {
            const isLoggedIn = localStorage.getItem('isLoggedIn');
            const currentUserId = localStorage.getItem('currentUserId');
            const userAccounts = JSON.parse(localStorage.getItem('userAccounts') || '[]');
            
            // 既にログイン済みの場合は自動的にカレンダーページにリダイレクト
            if (isLoggedIn === 'true' && currentUserId) {
                const currentUser = userAccounts.find(acc => acc.id.toString() === currentUserId);
                if (currentUser) {
                    // 登録済みユーザーは自動的にカレンダーへ
                    window.location.href = 'calendar.html';
                    return;
                } else {
                    // ユーザーが見つからない場合はログアウト状態に
                    localStorage.removeItem('currentUserId');
                    localStorage.removeItem('isLoggedIn');
                }
            }
            // 未登録の場合は登録リンクを表示（既に表示されている）
        });
    </script>
</body>